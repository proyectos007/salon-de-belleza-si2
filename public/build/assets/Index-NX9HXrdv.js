import{d as x,x as V,i as j,c as N,o as O,w as u,a as s,b as a,u as l,g as _,t as A,j as w,W as M}from"./app-13YhllzU.js";import{_ as R}from"./AppLayout-BZxvAeOc.js";import{a as B,s as c}from"./index-LCkz8Cdp.js";import{s as n}from"./index-D0b6ATor.js";import{s as C}from"./index-DGq_AH1Y.js";import{s as p}from"./index-DHd4Qs9j.js";import{s as U}from"./index-Bd2e2ua-.js";import"./index-DtiDn9lJ.js";import"./index-DzqK50WV.js";import"./index-DRxSqBOV.js";import"./index-C_4vxBeT.js";import"./index-CeOIhm3G.js";const z={class:"mt-4 bg-white shadow-md p-4 rounded-lg"},F={class:"flex justify-between my-5"},L={class:"card"},T={class:"flex gap-2"},W={class:"flex flex-col gap-2 mb-2"},q={class:"flex flex-col gap-2 mb-2"},D={class:"flex flex-col gap-2 mb-2"},G={class:"flex flex-col gap-2 mb-2"},H={class:"flex flex-col gap-2 mb-2"},I={class:"flex justify-between py-2"},J={class:"flex flex-col gap-2 mb-2"},K={class:"flex flex-col gap-2 mb-2"},P={class:"flex flex-col gap-2 mb-2"},Q={class:"flex justify-between py-2"},de={__name:"Index",props:{users:Object,roles:Object},setup(v){const f=x(!1),b=x(!1),g=x(null),i=V({name:"",email:"",role_id:null,password:"",password_confirmation:""}),t=V({id:null,name:"",email:"",role_id:null}),d=j(),S=r=>{var e;g.value=r,t.id=r.id,t.name=r.name,t.email=r.email,t.role_id=(e=r.roles[0])==null?void 0:e.id,b.value=!0},E=()=>{i.post(route("admin.users.store"),{preserveScroll:!0,preserveState:!0,onSuccess:r=>{console.log(`Respuesta ${JSON.stringify(r)}`),d.add({severity:"success",summary:"Éxito",life:5e3,detail:"Usuario creado correctamente"}),f.value=!1,i.reset()},onError:r=>{i.errors=r,r?Object.entries(r).forEach(([e,m])=>{Array.isArray(m)?m.forEach(o=>{d.add({severity:"error",summary:"Error",life:5e3,detail:o})}):d.add({severity:"error",summary:"Error",life:5e3,detail:m})}):d.add({severity:"error",summary:"Error",life:5e3,detail:"Ha ocurrido un error desconocido."})}})},k=r=>{confirm("¿Seguro que deseas eliminar este users?")&&M.delete(route("admin.users.destroy",r.id),{preserveScroll:!0,onSuccess:()=>d.add({severity:"success",summary:"Usuario eliminado exitosamente.",life:4e3})})},$=()=>{t.put(route("admin.users.update",t.id),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{d.add({severity:"success",summary:"Éxito",detail:"Usuario actualizado correctamente",life:5e3}),b.value=!1,t.reset()},onError:r=>{Object.values(r).flat().forEach(e=>{d.add({severity:"error",summary:"Error",detail:e,life:5e3})})}})};return(r,e)=>(O(),N(R,{title:"Usuarios"},{default:u(()=>{var m;return[s("div",z,[s("div",F,[e[13]||(e[13]=s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Gestionar usuarios ",-1)),a(l(n),{label:"Crear Usuarios",onClick:e[0]||(e[0]=()=>f.value=!0)})]),s("div",L,[a(l(B),{value:v.users,tableStyle:"min-width: 50rem"},{default:u(()=>[a(l(c),{field:"id",header:"Codigo"}),a(l(c),{field:"name",header:"Nombre"}),a(l(c),{field:"email",header:"Correo"}),a(l(c),{header:"Rol"},{body:u(({data:o})=>{var y;return[_(A((y=o.roles[0])==null?void 0:y.name),1)]}),_:1}),a(l(c),{header:"Acciones"},{body:u(({data:o})=>[s("div",T,[a(l(n),{label:"Editar",icon:"pi pi-pencil",onClick:()=>S(o),class:"p-button-sm"},null,8,["onClick"]),a(l(n),{icon:"pi pi-trash",severity:"danger",onClick:y=>k(o)},null,8,["onClick"])])]),_:1})]),_:1},8,["value"])]),a(l(C),{visible:f.value,"onUpdate:visible":e[7]||(e[7]=o=>f.value=o),class:"py-5 px-2",header:"Creando Usuario",style:{width:"25rem"}},{default:u(()=>[s("form",{onSubmit:w(E,["prevent"])},[s("div",W,[e[14]||(e[14]=s("label",{for:"name"},"Nombre",-1)),a(l(p),{id:"name",type:"text",placeholder:"Nombre del usuario",modelValue:l(i).name,"onUpdate:modelValue":e[1]||(e[1]=o=>l(i).name=o)},null,8,["modelValue"])]),s("div",q,[e[15]||(e[15]=s("label",{for:"email"},"Correo",-1)),a(l(p),{id:"email",type:"email",placeholder:"user@correo.com",modelValue:l(i).email,"onUpdate:modelValue":e[2]||(e[2]=o=>l(i).email=o)},null,8,["modelValue"])]),s("div",D,[e[16]||(e[16]=s("label",{for:"email"},"Rol",-1)),a(l(U),{modelValue:l(i).role_id,"onUpdate:modelValue":e[3]||(e[3]=o=>l(i).role_id=o),options:v.roles,optionValue:"id",optionLabel:"name",placeholder:"Selecciona el rol",class:"w-full"},null,8,["modelValue","options"])]),s("div",G,[e[17]||(e[17]=s("label",{for:"password"},"Contraseña",-1)),a(l(p),{id:"password",type:"password",placeholder:"Contraseña",modelValue:l(i).password,"onUpdate:modelValue":e[4]||(e[4]=o=>l(i).password=o)},null,8,["modelValue"])]),s("div",H,[e[18]||(e[18]=s("label",{for:"password"},"Confirmar Contraseña",-1)),a(l(p),{id:"password",type:"password",placeholder:"Confirma contraseña",modelValue:l(i).password_confirmation,"onUpdate:modelValue":e[5]||(e[5]=o=>l(i).password_confirmation=o)},null,8,["modelValue"])]),s("div",I,[a(l(n),{label:"Cancelar",onClick:e[6]||(e[6]=()=>f.value=!1),loading:l(i).processing},null,8,["loading"]),a(l(n),{label:"Crear",type:"submit",loading:l(i).processing},null,8,["loading"])])],32)]),_:1},8,["visible"]),a(l(C),{visible:b.value,"onUpdate:visible":e[12]||(e[12]=o=>b.value=o),header:`Editando Usuario (${(m=g.value)==null?void 0:m.name})`,style:{width:"25rem"},class:"py-5 px-2"},{default:u(()=>[s("form",{onSubmit:w($,["prevent"])},[s("div",J,[e[19]||(e[19]=s("label",{for:"edit-name"},"Nombre",-1)),a(l(p),{id:"edit-name",modelValue:l(t).name,"onUpdate:modelValue":e[8]||(e[8]=o=>l(t).name=o)},null,8,["modelValue"])]),s("div",K,[e[20]||(e[20]=s("label",{for:"edit-email"},"Correo",-1)),a(l(p),{id:"edit-email",modelValue:l(t).email,"onUpdate:modelValue":e[9]||(e[9]=o=>l(t).email=o)},null,8,["modelValue"])]),s("div",P,[e[21]||(e[21]=s("label",{for:"email"},"Rol",-1)),a(l(U),{modelValue:l(t).role_id,"onUpdate:modelValue":e[10]||(e[10]=o=>l(t).role_id=o),options:v.roles,optionValue:"id",optionLabel:"name",placeholder:"Selecciona el rol",class:"w-full"},null,8,["modelValue","options"])]),s("div",Q,[a(l(n),{label:"Cancelar",onClick:e[11]||(e[11]=()=>b.value=!1),loading:l(t).processing},null,8,["loading"]),a(l(n),{label:"Actualizar",type:"submit",loading:l(t).processing},null,8,["loading"])])],32)]),_:1},8,["visible","header"])])]}),_:1}))}};export{de as default};
